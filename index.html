<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chatbot with Wikipedia Fetching</title>
    <style>
        body { font-family: Arial, sans-serif; }
        #chatbox { border: 1px solid #ccc; height: 200px; overflow-y: auto; padding: 10px; }
        #thoughtsbox { border: 1px solid #ccc; height: 100px; overflow-y: auto; padding: 10px; margin-top: 10px; }
        #userInput { width: 80%; }
        button { margin-left: 10px; }
        .user-message { color: blue; }
        .bot-message { color: green; }
        .thought-message { color: gray; font-style: italic; }
        .wikipedia-content { border: 1px solid #ccc; padding: 10px; margin-top: 10px; }
    </style>
</head>
<body>
    <h1>AI Chatbot</h1>
    <div id="chatbox"></div>
    <div id="thoughtsbox"></div>
    <input type="text" id="userInput" placeholder="Type your message here...">
    <button onclick="sendMessage()">Send</button>

    <script>
        const chatbox = document.getElementById('chatbox');
        const thoughtsbox = document.getElementById('thoughtsbox');

        // Function to send a message
        async function sendMessage() {
            const userInput = document.getElementById('userInput').value;
            if (userInput.trim() === "") return;

            displayMessage(userInput, 'user');

            const botResponse = await getBotResponse(userInput);
            displayMessage(botResponse.response, 'bot');
            displayThoughts(botResponse.thoughts);

            document.getElementById('userInput').value = '';
            chatbox.scrollTop = chatbox.scrollHeight;
        }

        // Function to display messages in the chatbox
        function displayMessage(message, sender) {
            const messageElement = document.createElement('div');
            messageElement.textContent = message;
            messageElement.className = (sender === 'user') ? 'user-message' : 'bot-message';
            chatbox.appendChild(messageElement);
        }

        // Function to display thoughts in the thoughts box
        function displayThoughts(thoughts) {
            const thoughtsElement = document.createElement('div');
            thoughtsElement.textContent = thoughts;
            thoughtsElement.className = 'thought-message';
            thoughtsbox.appendChild(thoughtsElement);
        }

        // Function to get a response from the bot and fetch Wikipedia content if needed
        async function getBotResponse(input) {
            let response;
            let thoughts = "Thinking...";

            if (input.toLowerCase().includes("wikipedia")) {
                const wikiContent = await fetchWikipediaPage(input);
                response = wikiContent ? wikiContent : "I couldn't retrieve the information.";
                thoughts = "Fetching Wikipedia page content.";
            } else {
                response = "I'm not sure how to respond to that. Can you ask something else?";
                thoughts = "User asked something unclear.";
            }

            return { response, thoughts };
        }

        // Function to fetch the HTML content of a Wikipedia page
        async function fetchWikipediaPage(query) {
            const pageTitle = query.replace("wikipedia ", "").trim();
            const url = `https://en.wikipedia.org/wiki/${encodeURIComponent(pageTitle)}`;
            try {
                const response = await fetch(url);
                const text = await response.text();
                
                // Extract content from the fetched HTML (this is a basic way)
                const parser = new DOMParser();
                const doc = parser.parseFromString(text, 'text/html');
                const content = doc.querySelector('.mw-parser-output').innerText; // Get main content
                return content.split('\n').slice(0, 5).join('\n'); // Return the first 5 lines for brevity
            } catch (error) {
                console.error("Error fetching Wikipedia page:", error);
                return null;
            }
        }
    </script>
</body>
</html>
